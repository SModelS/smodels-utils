# LLP Maps #

This folder holds the main code for obtaining the efficiency maps for LLPs. Currently the following analyses are included:

  * [CMS-EXO-12-026](https://twiki.cern.ch/twiki/bin/view/CMSPublic/PhysicsResultsEXO12026) (8 TeV CMS HSCP)

## Basic Installation ##

The following codes must be installed:

  * [Pythia8](http://lcgapp.cern.ch/project/simu/HepMC/)
  * [MadGraph5](https://launchpad.net/mg5amcnlo/)

The script installer.sh will try to fetch the appropriate tarballs and install them.


## Running ##

Efficiency maps can be generated through the following set of commands:

```
./runGenEvents.py -p <parameter_file>
```

```
./getEffs.py -p <parameter_file>
```

```
./mergeEffs.py -p <parameter_file>
```

Below we discuss each individual step in detail.

### Generating Events ###

Efficiencies for a single parameter point can be computed running:

```
./CMS-EXO-12-026/main_hscp.exe -f <lhe_file>
```

where lhe_file is a parton level LHE file produced by MadGraph.
Running the above code calls Pythia8 for the decay, shower and hadronization steps. The output is a simplified LHE file containing the 4-momenta for the isolated HSCPs in each event and the corresponding trigger and acceptance efficiencies.

The script [runGenEvents.py](runGenEvents.py) allows to loop over the parameter space and generate the simplified event files for each set of parameters.
It calls MadGraph to generate parton level events and Pythia8 ([main_hscp.exe](main_hscp.exe)) for the recasting.
All the settings for running MadGraph and the recasting are defined by a
 configuration file (e.g. [parameters_THSCPM7.ini](./eff_parameters_default.ini)).
 The parameter card used by MadGraph is stored (as a SLHA file) as well as the run banner.

### Computing Efficiencies for multiple Lifetimes ###

Efficiencies for distinct HSCP lifetimes can be analytically computed using the
simplified events generated by [main_hscp.exe](main_hscp.exe) or [runGenEvents.py](runGenEvents.py).
The script [getEffs.py](getEffs.py) reads the simplified LHE events and compute efficiencies for distinct lifetimes. The widths, detector size and input files must be defined by the configuration file [eff_parameters.ini](eff_parameters.ini).
The output is a set of files (one for each input LHE file) containing the efficiencies for the signal regions as a function of the widths.


### Building Efficiency Maps ###

Finally, the script [mergeEffs.py](mergeEffs.py) combines the efficiency files generated by [getEffs.py](getEffs.py) and produces a single file with the efficiencies for all mass parameters and widths.
